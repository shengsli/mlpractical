import numpy as np
import matplotlib.pyplot as plt
import csv

# stats_dict = {
#     "train_acc": data[:,0],
#     "train_loss": data[:,1],
#     "val_acc": data[:,2],
#     "val_loss": data[:,3]
# }

dim_reduction = "avg_pooling"
fig_title = "Val loss of max pooling"
save_fig_name = '{0}.pdf'.format(dim_reduction)

for layer_num in range(2,6):
    best_model_data = np.loadtxt('{0}_{1}layers_64filters/result_outputs/test_summary.csv'.format(dim_reduction,layer_num),
                      delimiter=',', skiprows=1)
    data = np.loadtxt('{0}_{1}layers_64filters/result_outputs/summary.csv'.format(dim_reduction,layer_num),
                      delimiter=',', skiprows=1)
    best_val_epoch = np.argmin(data[:,3])
    print("%d, %.3f, %.3f" % (best_val_epoch,best_model_data[0],best_model_data[1]))
    plt.plot(data[:,3], label='{0}layers'.format(layer_num))

plt.legend()
plt.title(fig_title)
plt.xlabel("epoch")
plt.ylabel("loss")
plt.savefig(save_fig_name)
plt.show()
